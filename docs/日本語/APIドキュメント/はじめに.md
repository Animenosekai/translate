
# translatepy APIリファレンス

translatepy APIリファレンスへようこそ！

## 全体的に

### レスポンスの形式

一般的に、JSONで形式されたレスポンスは以下の形に返されます（エラーが発生された時もこの形で返されます）

```json
{
    "success": true,
    "message": "出来ました!",
    "error": null,
    "data": {}
}
```

| フィールド     | 詳細                            |  null可能         |
| ------------ | ------------------------------  | ---------------- |
| `success`    | リクエストが成功したかどうか         | False            |
| `message`    | 何があったか説明する文章            | True             |
| `error`      | エラーが発生した時のエラー名         | True             |
| `data`       | 解答のデータ、リクエストされたデータ  | False            |

### エラー

サーバー上でも、リクエストからでも、様々なエラーが発生する可能性があります。

特定なエラーはそれぞれのエンドポイントドキュメントで説明されていなすが、以下に一般的に発生可能のエラーを説明します

| エラー名                     | 詳細                                                                                                             | コード  |
| --------------------------- | --------------------------------------------------------------------------------------------------------------- | ----- |
| `SERVER_ERROR`              | リクエストの処理中でサーバー上のエラーが発生した時                                                                       | 500   |
| `MISSING_CONTEXT`           | Nasseコンテキストに居ないのに、Nasseコンテキストのみで利用可能のデータをアクセスしようとしたとき                               | 500   |
| `INTERNAL_SERVER_ERROR`     | システム上でエラーが発生した時                                                                                       | 500   |
| `METHOD_NOT_ALLOWED`        | HTTPリクエストメソッドを間違えた時                                                                                   | 405   |
| `CLIENT_ERROR`              | リクエストで何か足りないかダメな時                                                                                    | 400   |
| `MISSING_VALUE`             | リクエストから何か足りない時                                                                                         | 400   |
| `MISSING_PARAM`             | 必要のパラメーターが一つリクエストから不足している時                                                                     | 400   |
| `MISSING_DYNAMIC`           | ダイナミックURLのパーツが一つURLから不足している時                                                                      | 400   |
| `MISSING_HEADER`            | 必要のヘッダーが一つリクエストから不足している時                                                                        | 400   |
| `MISSING_COOKIE`            | 必要のクッキーが一つリクエストから不足している時                                                                        | 400   |
| `AUTH_ERROR`                | 認証中にエラーが発生した時                                                                                           | 403   |

### 認証されたリクエスト

ユーザーがログインされていること

ユーザーのログインが必要な場合、「Authorization」ヘッダーがログインの時に送られたトークンに設定されることが必要です。

「translatepy_token」のパラメーターと「__translatepy_token」のクッキーも利用可能ですがこれらは優先されません

エンドポイントの認証ルールが「検証のみ」になっている場合は、アカウントがデータベースから読み込む事なく、トークンの形式や有効期限をチェックするだけです。

### デバッグモード

デバッグモードが有効の時(`-d`か`--debug`)は、色々な情報が`debug`フィールドで返送されて、`DEBUG`のロギングレベルが選ばれます。

'debug'フィルーどは重大なエラー（`INTERNAL_SERVER_ERROR`、 `METHOD_NOT_ALLOWED`、 など）しない限り、送られます。(重大なエラーが発生したら、なるべくもう一度エラーが発生しないようにする必要があります)

`call_stack`フィールドは`call_stack`パラメーターをリクエストで入れる時だけ送信されます。

```json
{
    "success": true,
    "message": "リクエストが成功しませんでした",
    "error": null,
    "data": {
        "username": "Animenosekai"
    },
    "debug": {
        "time": {
            "global": 0.036757,
            "verification": 0.033558,
            "authentication": 0.003031,
            "processing": 4.9e-05,
            "formatting": 0.0001
        },
        "ip": "127.0.0.1",
        "headers": {
            "Host": "api.translatepy.com",
            "Connection": "close",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
            "Accept-Language": "fr-fr",
            "Accept-Encoding": "gzip, deflate, br",
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15"
        },
        "values": {},
        "domain": "api.translatepy.com",
        "logs": [
            "1636562693.036563｜[INFO] [nasse.receive.Receive.__call__] → Incoming GET request to /account/name from 127.0.0.1",
            "1636562693.070008｜[ERROR] [nasse.exceptions.base.MissingToken.__init__] An authentication token is missing from the request"
        ],
        "call_stack": [
            "pass the 'call_stack' parameter to get the call stack"
        ]
    }
}
```

## インデックス

- [Language](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Language.md#language)
  - [Language Details](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Language.md#language-details)
  - [Language Search](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Language.md#language-search)
  - [Language Details (dynamic)](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Language.md#language-details-dynamic)
- [Stars](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stars.md#stars)
  - [Stars](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stars.md#stars-1)
  - [Translation Star](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stars.md#translation-star)
- [Stats](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stats.md#stats)
  - [Timings Stats](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stats.md#timings-stats)
  - [Errors Stats](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Stats.md#errors-stats)
- [Translation](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#translation)
  - [Translate](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#translate)
  - [Translation Stream](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#translation-stream)
  - [Translate HTML](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#translate-html)
  - [Transliterate](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#transliterate)
  - [Spellcheck](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#spellcheck)
  - [Language](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#language-1)
  - [Text to Speech](./%E3%82%BB%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/Translation.md#text-to-speech)
